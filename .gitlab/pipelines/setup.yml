.setup_poetry:
  script:
    - pip install --upgrade pip
    - pip install poetry
    - poetry config virtualenvs.create false

.install:
  script:
    - !reference [.setup_poetry, script]
    - poetry install --without=dev

.install_dev:
  script:
    - !reference [.setup_poetry, script]
    - poetry install

.install_only_dev:
  script:
    - !reference [.setup_poetry, script]
    - poetry install --only=dev

.setup_pypi:
  script:
    - poetry config pypi-token.pypi ${PYPI_TOKEN}

.setup_testpypi:
  script:
    - poetry config repositories.testpypi https://test.pypi.org/legacy/
    - poetry config pypi-token.testpypi ${TESTPYPI_TOKEN}